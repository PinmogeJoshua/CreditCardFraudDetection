使用smote进行过采样
# 使用 SMOTE 进行过采样
from imblearn.over_sampling import SMOTE
from collections import Counter

# 分离特征和目标变量
X = data.drop(columns=['Class'])
y = data['Class']

# 应用 SMOTE
smote = SMOTE(random_state=42)
X_resampled, y_resampled = smote.fit_resample(X, y)

# 检查重新采样后的目标变量分布
print(f"Original dataset class distribution: {Counter(y)}")
print(f"Resampled dataset class distribution: {Counter(y_resampled)}")

# 可视化重新采样后的分布
sns.countplot(x=y_resampled)
plt.title('Resampled Class Distribution')
plt.xlabel('Class')
plt.ylabel('Frequency')
plt.show()



使用加权损失函数训练模型
# 使用加权损失函数训练模型
from sklearn.linear_model import LogisticRegression
from sklearn.utils.class_weight import compute_class_weight

# 计算类别权重
class_weights = compute_class_weight('balanced', classes=np.unique(y), y=y)
class_weights_dict = {0: class_weights[0], 1: class_weights[1]}
print(f"Class Weights: {class_weights_dict}")

# 初始化逻辑回归模型并设置 class_weight 参数
model = LogisticRegression(class_weight=class_weights_dict, random_state=42)
model.fit(X, y)